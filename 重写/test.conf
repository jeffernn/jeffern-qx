// Quantumult X MITM 重写脚本：劫持抽奖接口并返回自定义奖品响应
const re = /^https:\/\/shop\.sxxe\.net\/gacha\/spin/;

// 脚本类型：response（修改响应）
// 匹配规则：目标URL
// 动作：替换响应体+设置响应头
rewriteResponse({
    url: re,
    body: (body) => {
        // 自定义要返回的JSON响应体
        const customResponse = {
            "success": true,
            "delivery_status": "success",
            "prize": {
                "probability": 0.10000000000000001,
                "id": "10GB",
                "bytes": 10737418240,
                "icon": "server",
                "name": "999 GB",
                "color": "text-purple-500"
            },
            "new_balance": 20
        };
        // 将JSON对象转为字符串返回
        return JSON.stringify(customResponse, null, 2);
    },
    headers: (headers) => {
        // 确保响应头正确，标识返回的是JSON格式
        headers['Content-Type'] = 'application/json; charset=utf-8';
        headers['Access-Control-Allow-Origin'] = '*'; // 避免跨域问题（可选）
        return headers;
    },
    statusCode: 200 // 强制返回200成功状态码
});

$done({});
